"use strict";(self.webpackChunkvaultiscan_embedding_sdk_docs=self.webpackChunkvaultiscan_embedding_sdk_docs||[]).push([[3028],{8202:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"connectors/sharepoint/configuration","title":"SharePoint OAuth Configuration","description":"Configure Azure AD OAuth credentials to securely connect your SharePoint site for document access and AI-powered analysis.","source":"@site/docs/connectors/sharepoint/configuration.md","sourceDirName":"connectors/sharepoint","slug":"/connectors/sharepoint/configuration","permalink":"/docs/connectors/sharepoint/configuration","draft":false,"unlisted":false,"editUrl":"https://github.com/vaultiscan/vaultiscan.github.io/tree/main/docs/connectors/sharepoint/configuration.md","tags":[],"version":"current","frontMatter":{"title":"SharePoint OAuth Configuration","sidebar_label":"SharePoint OAuth Configuration"},"sidebar":"sharepointSidebar","previous":{"title":"SharePoint Connector","permalink":"/docs/connectors/sharepoint/intro"},"next":{"title":"VaultiScan Setup (SharePoint)","permalink":"/docs/connectors/sharepoint/vaultiscan-setup"}}');var s=t(4848),r=t(8453);const o={title:"SharePoint OAuth Configuration",sidebar_label:"SharePoint OAuth Configuration"},a="SharePoint OAuth Configuration",c={},l=[{value:"Basic Setup",id:"basic-setup",level:2},{value:"Steps Overview",id:"steps-overview",level:3},{value:"Step 1: Register an App in Azure AD",id:"step-1-register-an-app-in-azure-ad",level:2},{value:"Step 2: Configure Microsoft Graph API Permissions",id:"step-2-configure-microsoft-graph-api-permissions",level:2},{value:"Step 3: Request administrator consent",id:"step-3-request-administrator-consent",level:2},{value:"Step 4: Add Client Secret or Certificate",id:"step-4-add-client-secret-or-certificate",level:2},{value:"Step 5: Obtain Tenant ID and Client ID",id:"step-5-obtain-tenant-id-and-client-id",level:2},{value:"Step 6: Request an access token",id:"step-6-request-an-access-token",level:2},{value:"Step 7: Use the access token to call Microsoft Graph",id:"step-7-use-the-access-token-to-call-microsoft-graph",level:2}];function d(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"sharepoint-oauth-configuration",children:"SharePoint OAuth Configuration"})}),"\n",(0,s.jsx)(n.p,{children:"Configure Azure AD OAuth credentials to securely connect your SharePoint site for document access and AI-powered analysis."}),"\n",(0,s.jsx)(n.h2,{id:"basic-setup",children:"Basic Setup"}),"\n",(0,s.jsx)(n.p,{children:"To enable secure access to SharePoint Online via Microsoft Graph API, configure OAuth 2.0 client credentials in the Azure portal following the client credentials grant flow (app-only)."}),"\n",(0,s.jsx)(n.h3,{id:"steps-overview",children:"Steps Overview"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Register your application in Microsoft Entra ID (Azure AD)"}),"\n",(0,s.jsx)(n.li,{children:"Configure API permissions for Microsoft Graph (Application permissions)"}),"\n",(0,s.jsx)(n.li,{children:"Grant administrator consent for permissions"}),"\n",(0,s.jsx)(n.li,{children:"Create client secret or certificate"}),"\n",(0,s.jsx)(n.li,{children:"Configure redirect URIs (if applicable)"}),"\n",(0,s.jsx)(n.li,{children:"Obtain tenant ID, client ID, client secret"}),"\n",(0,s.jsx)(n.li,{children:"Use client credentials flow to request access tokens"}),"\n",(0,s.jsx)(n.li,{children:"Connect VaultiScan SharePoint Connector using these credentials"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"step-1-register-an-app-in-azure-ad",children:"Step 1: Register an App in Azure AD"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Sign in to the ",(0,s.jsx)(n.a,{href:"https://entra.microsoft.com/",children:"Microsoft Entra admin center"})," as at least an ",(0,s.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/permissions-reference#application-developer",children:"Application Developer"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"If you have access to multiple tenants, use the Settings icon in the top menu to switch to the tenant in which you want to register the application"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Browse to Entra ID > App registrations and select New registration."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Enter a meaningful Name for your app, for example identity-client-app. App users can see this name, and it can be changed at any time. You can have multiple app registrations with the same name."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Under Supported account types, specify who can use the application. We recommend you select Accounts in this organizational directory only for most applications."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Select Register to complete the app registration."}),"\n",(0,s.jsx)("img",{src:"/img/sharepoint/sp_1.png",alt:"Open Project Picker",width:"1200"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"The application's Overview page is displayed. Record the Application (client) ID, which uniquely identifies your application and is used in your application's code as part of validating the security tokens it receives from the Microsoft identity platform."}),"\n",(0,s.jsx)("img",{src:"/img/sharepoint/sp_2.png",alt:"Open Project Picker",width:"1200"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"\ud83d\udca1 Make sure the new project is selected before continuing."}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"step-2-configure-microsoft-graph-api-permissions",children:"Step 2: Configure Microsoft Graph API Permissions"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Sign in to the ",(0,s.jsx)(n.a,{href:"https://entra.microsoft.com/",children:"Microsoft Entra admin center"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Expand ",(0,s.jsx)(n.strong,{children:"Identity > Applications >"})," select ",(0,s.jsx)(n.strong,{children:"App registrations"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["In the ",(0,s.jsx)(n.strong,{children:"App registrations"})," window, under the All applications tab, select the app that you want to add Azure AD Graph permissions to."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"From the left pane of the window, under the Manage menu group, select API permissions. In the Configured permissions window, select Add a permission."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Select Microsoft Graph > select Application permissions."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"In the Select Permissions dialog, choose the permissions to configure to the app."}),"\n",(0,s.jsx)("img",{src:"/img/sharepoint/sp_3.png",alt:"Open Project Picker",width:"1200"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"step-3-request-administrator-consent",children:"Step 3: Request administrator consent"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"With requests to the /adminconsent endpoint, Microsoft Entra ID enforces that only an authorized administrator can sign in to complete the request. The administrator is asked to approve all the application permissions that you requested for your app in the app registration portal."}),"\n",(0,s.jsx)("img",{src:"/img/sharepoint/sp_4.png",alt:"Open Project Picker",width:"500"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"step-4-add-client-secret-or-certificate",children:"Step 4: Add Client Secret or Certificate"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Under ",(0,s.jsx)(n.strong,{children:"Certificates & secrets"}),", click ",(0,s.jsx)(n.strong,{children:"New client secret"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Add description and expiry, then ",(0,s.jsx)(n.strong,{children:"Add"}),"."]}),"\n",(0,s.jsx)(n.li,{children:"Copy the secret value immediately (you\u2019ll need it in VaultiScan)."}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"step-5-obtain-tenant-id-and-client-id",children:"Step 5: Obtain Tenant ID and Client ID"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Tenant ID is found under ",(0,s.jsx)(n.strong,{children:"Azure Active Directory \u2192 Overview"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Client ID is shown in the app registration ",(0,s.jsx)(n.strong,{children:"Overview"})," page."]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"step-6-request-an-access-token",children:"Step 6: Request an access token"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"In the OAuth 2.0 client credentials grant flow, use the application ID and client secret values that you saved when you registered your app to request an access token directly from the Microsoft identity platform /token endpoint."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Specify the preconfigured permissions by passing ",(0,s.jsx)(n.a,{href:"https://graph.microsoft.com/.default",children:"https://graph.microsoft.com/.default"})," as the value for the scope parameter in the token request."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Request"}),"\n// Line breaks are for legibility only."]}),"\n",(0,s.jsxs)(n.p,{children:["POST ",(0,s.jsx)(n.a,{href:"https://login.microsoftonline.com/%7Btenant%7D/oauth2/v2.0/token",children:"https://login.microsoftonline.com/{tenant}/oauth2/v2.0/token"})," HTTP/1.1\nHost: login.microsoftonline.com\nContent-Type: application/x-www-form-urlencoded"]}),"\n",(0,s.jsx)(n.p,{children:"client_id=535fb089-9ff3-47b6-9bfb-4f1264799865\n&scope=https%3A%2F%2Fgraph.microsoft.com%2F.default\n&client_secret=qWgdYA....L1qKv5bPX\n&grant_type=client_credentials"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Response"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "token_type": "Bearer",\n  "expires_in": 3599,\n  "ext_expires_in": 3599,\n  "access_token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ik1uQ19WWmNBVGZNNXBP..."\n}\n'})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"step-7-use-the-access-token-to-call-microsoft-graph",children:"Step 7: Use the access token to call Microsoft Graph"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"After you get an access token, the app uses it to call Microsoft Graph by attaching the access token as a Bearer token to the Authorization header in an HTTP request. The following request gets all users in the tenant. The app must have the User.Read.All permission to call this API."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Request"})}),"\n",(0,s.jsxs)(n.p,{children:["GET ",(0,s.jsx)(n.a,{href:"https://graph.microsoft.com/v1.0/users",children:"https://graph.microsoft.com/v1.0/users"})," HTTP/1.1\nAuthorization: Bearer eyJ0eXAiO ... 0X2tnSQLEANnSPHY0gKcgw\nHost: graph.microsoft.com"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Response"})}),"\n",(0,s.jsx)(n.p,{children:"HTTP/1.1 200 OK\nContent-Type: application/json;odata.metadata=minimal;odata.streaming=true;IEEE754Compatible=false;charset=utf-8\nrequest-id: f45d08c0-6901-473a-90f5-7867287de97f\nclient-request-id: f45d08c0-6901-473a-90f5-7867287de97f\nOData-Version: 4.0\nDate: Wed, 26 Apr 2017 19:53:49 GMT\nContent-Length: 407"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'\n{\n"@odata.context": "https://graph.microsoft.com/v1.0/$metadata#users",\n"value": [\n{\n"businessPhones": [],\n"displayName": "Conf Room Adams",\n"givenName": null,\n"jobTitle": null,\n"mail": "Adams@Contoso.com",\n"mobilePhone": null,\n"officeLocation": null,\n"preferredLanguage": null,\n"surname": null,\n"userPrincipalName": "Adams@Contoso.com",\n"id": "8afc02cb-4d62-4dba-b536-9f6d73e9be26"\n},\n{\n"businessPhones": [\n"+1 425 555 0109"\n],\n"displayName": "Adele Vance",\n"givenName": "Adele",\n"jobTitle": "Retail Manager",\n"mail": "AdeleV@Contoso.com",\n"mobilePhone": null,\n"officeLocation": "18/2111",\n"preferredLanguage": null,\n"surname": "Vance",\n"userPrincipalName": "AdeleV@Contoso.com",\n"id": "59bb3898-0621-4414-ac61-74f9d7201355"\n}\n]\n}\n\n'})}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>a});var i=t(6540);const s={},r=i.createContext(s);function o(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);