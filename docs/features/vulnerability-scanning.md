# Vulnerability Scanning

Perform comprehensive security assessments with VaultiScan's vulnerability scanning capabilities.

## Overview

VaultiScan's vulnerability scanning engine identifies security weaknesses across:

- **Web Applications** - OWASP Top 10 vulnerabilities
- **APIs** - REST, GraphQL, and SOAP endpoints
- **Infrastructure** - Network and system configurations
- **Code** - Static analysis of source code

## Basic Scanning

### Quick Scan

```javascript
import { VaultiScanSDK } from '@vaultiscan/embedding-sdk';

const sdk = new VaultiScanSDK({ apiKey: 'your-api-key' });

const scan = await sdk.vulnerabilities.scan({
  target: 'https://example.com',
  type: 'web'
});

console.log('Scan ID:', scan.id);
```

### Comprehensive Scan

```javascript
const scan = await sdk.vulnerabilities.scan({
  target: 'https://api.example.com',
  type: 'api',
  options: {
    depth: 'deep',
    includeSubdomains: true,
    authentication: {
      type: 'bearer',
      token: 'api-token'
    }
  }
});
```

## Scan Types

### Web Application Scanning

```javascript
const webScan = await sdk.vulnerabilities.scan({
  target: 'https://webapp.example.com',
  type: 'web',
  checks: [
    'sql_injection',
    'xss',
    'csrf',
    'authentication',
    'authorization',
    'ssl_tls'
  ]
});
```

### API Security Scanning

```javascript
const apiScan = await sdk.vulnerabilities.scan({
  target: 'https://api.example.com',
  type: 'api',
  swagger: 'https://api.example.com/swagger.json',
  checks: [
    'injection',
    'broken_authentication',
    'sensitive_data_exposure',
    'xxe',
    'broken_access_control'
  ]
});
```

### Infrastructure Scanning

```javascript
const infraScan = await sdk.vulnerabilities.scan({
  target: '192.168.1.0/24',
  type: 'infrastructure',
  checks: [
    'open_ports',
    'service_versions',
    'ssl_certificates',
    'misconfigurations'
  ]
});
```

## Real-time Results

Monitor scan progress and get real-time updates:

```javascript
// Start scan
const scan = await sdk.vulnerabilities.scan({
  target: 'https://example.com',
  type: 'web'
});

// Listen for updates
scan.onProgress((progress) => {
  console.log(`Scan progress: ${progress.percentage}%`);
  console.log(`Current phase: ${progress.phase}`);
});

scan.onVulnerabilityFound((vuln) => {
  console.log(`Vulnerability found: ${vuln.title}`);
  console.log(`Severity: ${vuln.severity}`);
});

// Wait for completion
const results = await scan.waitForCompletion();
```

## Vulnerability Details

Each vulnerability includes comprehensive information:

```javascript
const results = await scan.getResults();

results.vulnerabilities.forEach(vuln => {
  console.log({
    id: vuln.id,
    title: vuln.title,
    severity: vuln.severity, // critical, high, medium, low
    category: vuln.category,
    description: vuln.description,
    impact: vuln.impact,
    remediation: vuln.remediation,
    cve: vuln.cve,
    cvss: vuln.cvss,
    location: vuln.location,
    evidence: vuln.evidence
  });
});
```

## Filtering and Sorting

```javascript
// Filter by severity
const criticalVulns = results.vulnerabilities.filter(
  vuln => vuln.severity === 'critical'
);

// Sort by CVSS score
const sortedVulns = results.vulnerabilities.sort(
  (a, b) => b.cvss.score - a.cvss.score
);

// Group by category
const groupedVulns = results.vulnerabilities.reduce((acc, vuln) => {
  acc[vuln.category] = acc[vuln.category] || [];
  acc[vuln.category].push(vuln);
  return acc;
}, {});
```

## Custom Vulnerability Checks

Define custom security checks:

```javascript
const customScan = await sdk.vulnerabilities.scan({
  target: 'https://example.com',
  type: 'custom',
  checks: [
    {
      name: 'custom_header_check',
      description: 'Check for security headers',
      severity: 'medium',
      test: async (target) => {
        const response = await fetch(target);
        return {
          vulnerable: !response.headers.get('X-Frame-Options'),
          evidence: 'Missing X-Frame-Options header'
        };
      }
    }
  ]
});
```

## Next Steps

- [Security Reports →](./security-reports)
- [Real-time Monitoring →](./monitoring)
- [API Reference →](../api)
